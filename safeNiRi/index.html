<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NiRi</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="movement-buttons">
      <button id="moveleft">left</button>
      <button id="moveright">right</button>
    </div>
    <div class="mainframe">
      <h1 class="title">Safe NiRi</h1>
      <h2 class="subtitle">
        ver. 18.13. — by Nici <br />© All rights reserved NiRi
      </h2>

      <button class="startbutton" id="start" onclick="startGame()">
        Start
      </button>

      <img class="ninew2" src="assets/Nici.png" alt="" />
      <img class="ninew" src="assets/Nici.png" alt="" />

      <img class="ri-character2" src="assets/Ri.png" alt="" />
      <img class="ri-character" src="assets/Ri.png" alt="" />

      <div class="scene">
        <img class="ni-character2" src="assets/Nici.png" alt="" />
        <img class="ni-character" src="assets/Nici.png" alt="" />

        <div class="endcard">
          <p>
            A lot happened that was never intended.<br />
            Try using the button to save the relationship.<br />
            There's always hope, so don't give up!
          </p>
          <button id="safe">We will figure it out.</button>
          <a href="failed.html"
            ><button class="notsafe">its too late</button></a
          >
        </div>

        <img class="scene-image" src="assets/startscreen.gif" alt="" />
        <img class="scene-image" src="assets/startscreen.gif" alt="" />

        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/ROMA.png" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/SARDINIEN.png" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/FIRENZE.png" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/PARIGI.png" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/NY.png" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/SICILY.png" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/DOLOMITI.png" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" src="assets/final.gif" alt="" />
        <img class="scene-image" id="finalimg" src="assets/DATE.png" alt="" />
        <img class="scene-image" id="safed" src="assets/SAFE.png" alt="" />

        <img class="scene-image" src="assets/DATE2.png" alt="" />
      </div>
    </div>
    <script>
      const scene = document.querySelector(".scene");
      const btnRight = document.getElementById("moveright");
      const btnLeft = document.getElementById("moveleft");
      let bgmusic = new Audio("assets/bgmusic.mp3");

      let posX = 0;
      const step = 350;
      let endReached = false;

      function startGame() {
        bgmusic.loop = true;
        bgmusic.volume = 0.05;
        bgmusic.play();

        document.getElementById("start").style.display = "none";
        document.querySelector(".title").style.display = "none";
        document.querySelector(".subtitle").style.display = "none";

        setTimeout(() => {
          document.querySelector(".ri-character").style.display = "block";
          document.querySelector(".ri-character2").style.display = "block";
        }, 2000);

        setTimeout(() => {
          document.getElementById("moveleft").style.display = "block";
        }, 3500);
        setTimeout(() => {
          document.getElementById("moveright").style.display = "block";
        }, 3800);
      }

      // Standard: weiche Bewegung
      scene.style.transition = "transform 0.3s ease-in-out";

      btnRight.addEventListener("click", () => {
        posX -= step;
        updatePosition();
      });

      btnLeft.addEventListener("click", () => {
        posX += step;
        updatePosition();
      });
      function updatePosition() {
        const frameWidth = window.innerWidth;
        const sceneWidth = scene.scrollWidth;

        const maxOffset = 0;
        const minOffset = -(sceneWidth - frameWidth * 1.35);

        posX = Math.max(Math.min(posX, maxOffset), minOffset);

        scene.style.transform = `translateX(${posX}px)`;

        if (posX === minOffset && !endReached) {
          endReached = true;
          console.log("Ende erreicht!");
          document.getElementById("moveleft").style.display = "none";
          document.getElementById("moveright").style.display = "none";
          document.querySelector(".endcard").style.display = "block";

          endcard.style.display = "block";
        }
      }

      const character = document.querySelector(".ni-character");
      const characterBlurred = document.querySelector(".ni-character2");

      const newChar = document.querySelector(".ninew");
      const newCharBlurred = document.querySelector(".ninew2");

      const finalscene = document.querySelector("#finalimg");
      const safedscene = document.querySelector("#safed");

      const popup = document.querySelector(".endcard");
      const finalImage = document.querySelector("#finalimg");

      let currentLeft = 95;

      document.getElementById("safe").addEventListener("click", () => {
        if (currentLeft > 94) {
          currentLeft -= 0.1;
          character.style.left = currentLeft + "%";
          characterBlurred.style.left = currentLeft + "%";
        } else {
          character.style.display = "none";
          characterBlurred.style.display = "none";
          newChar.style.display = "block";
          newCharBlurred.style.display = "block";
          popup.style.display = "none";
          bgmusic.volume = 0.4;
          finalscene.style.display = "none";
          safedscene.style.display = "block";
        }
      });
    </script>
  </body>
</html>
